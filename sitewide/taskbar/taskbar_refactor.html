<!DOCTYPE html>
<html>

<head>
   <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
   <!--
   Normally this stylesheet linking is managed by the importer script,
   however because this is the base template we do not use that script for
   development.
   -->
   <link rel="stylesheet" href="taskbar2.css">
</head>

<body>
   <!--
   This is all included in one large div. Previously I was using an iframe
   and importing an entire page into it's parent, now we use fetch and parse
   with a DOMParser to grab the taskbar div and useful script tags.
   -->
   <div id="taskbar" class="win95">
      <!--
      The taskbar primarily contains two types of tag groups to define the
      system tray.
      
      For "shy" icons who only stay open on focus, a button
      with the class "taskbarButton" should be used on a <button> tag.

      For "confident" icons who's state is determined by a toggle, an
      invisible checkbox and styled label are used, with the checkbox inheriting
      the "taskbarEntry" class which, when paired with a label defines the style.

      As "confident" icons usually also define the visual state of some app's
      window, any app's window/containing div should be a child of the "confident"
      icon to reap the benefit of CSS's :checked pseudo-class.
      -->
      <button id="startButton" class="win95 taskbarButton">
         <img src="/sitewide/images/icons/INFO.ico">
         <p style="-webkit-text-stroke: 1px black;">Start</p>
         <!--
         The start menu itself is contained in this button for the fact that
         visual state can be handled by as much CSS as possible. A little bit of
         JS is needed in the logic of the start button because a checkbox cannot 
         be inherently focused and thus CSS only will not allow it to function
         like a traditional Windows Start button.
         -->
         <div id="startMenu" class="win95" anchor="startButton">
            <div id="startMenuBanner">
               <div style="writing-mode: vertical-lr; transform: rotate(180deg); ">
                  <b>epsilon</b>
                  <p>OS</p>
               </div>
            </div>
            <div id="startMenuContents">
               <!--
               The top-level start menu has 3 styled classes for different use cases.

               A "startMenuFolder" classed object will act as a containing div for
               more elements of the same 3 types, and only shows contents on hover.
               
               A "startMenuLink" classed object will act as a normal link in as a
               normal link tag, however the current precedent is anything not of
               same origin will target _blank, otherwise rel="noreferrer".

               A "startMenuLink" classed object will act differently depending on
               needs, sometimes opening an application or performing some task,
               which is determined by it's "onclick" attribute.

               All three must also have a "startMenuEntry" class which styles for
               user hovering and basic coloring.

               If a divider is needed on the menu, use the startBorderTop or 
               startBorderBottom classes.

               All sub-menus are similar in their naming schema and usage, however
               they are styled more appropriately and have the infix "Sub" following
               "start". These also are stored in a div called startSubMenu.
               -->
               <div class="startMenuFolder startMenuEntry">
                  <img src="/sitewide/images/icons/Sync Earth.ico">
                  <p>LINKS</p>
                  <div class="startSubMenu growFromTop win95">
                     <a class="startSubMenuLink startSubMenuEntry"
                        href="https://open.spotify.com/artist/1hMrh5wetHbeiJYBezuEPs?si=aXMsvaFwT86NiAlWRh3fMw"
                        target="_blank">
                        <img src="/sitewide/taskbar/logos/spotify_logo.png">
                        <p>Spotify</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry" href="https://varphiartist.bandcamp.com/"
                        target="_blank">
                        <img src="/sitewide/taskbar/logos/bandcamp_logo.png">
                        <p>Bandcamp</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry" href="https://www.youtube.com/@varphiartist"
                        target="_blank">
                        <img src="/sitewide/taskbar/logos/youtube_logo.webp">
                        <p>YouTube</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry"
                        href="https://music.apple.com/ee/artist/varphi/1648184088" target="_blank">
                        <img src="/sitewide/taskbar/logos/apple_music_logo.png">
                        <p>Apple Music</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry startBorderTop"
                        href="https://github.com/varphi-online" target="_blank">
                        <img src="/sitewide/taskbar/logos/github_logo.webp">
                        <p>Github</p>
                     </a>
                  </div>
               </div>
               <div class="startMenuFolder startMenuEntry">
                  <img src="/sitewide/images/icons/Music sheet (black).ico">
                  <p>MUSIC</p>
                  <div class="startSubMenu growFromTop win95">
                     <a class="startSubMenuLink startSubMenuEntry" href="/pages/music/orbit/orbit.html" target="_blank">
                        <img src="/pages/music/orbit/orbit.png">
                        <p>Orbit</p>
                     </a>
                  </div>
               </div>
               <div class="startMenuFolder startMenuEntry">
                  <img src="/sitewide/images/icons/Folder catalog.ico">
                  <p>Other Projects</p>
                  <div class="startSubMenu growFromBottom win95">
                     <a class="startSubMenuLink startSubMenuEntry" href="https://github.com/varphi-online/website"
                        target="_blank">
                        <img src="/sitewide/images/icons/Installation on computer (discs).ico">
                        <p>varphi.online</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry" href="https://github.com/varphi-online/phi-dark"
                        target="_blank">
                        <img src="/sitewide/taskbar/logos/phi_dark_icon.png">
                        <p>Phi Dark</p>
                     </a>
                     <a class="startSubMenuLink startSubMenuEntry" href="/pages/math/text_calc/calc.html"
                        target="_blank">
                        <img src="/sitewide/images/icons/Calculator.ico">
                        <p>Text Calculator</p>
                     </a>
                  </div>
               </div>
               <a class="startMenuLink startMenuEntry" href="https://varphi-online.github.io/wgraphc/" target="_blank">
                  <img src="/sitewide/taskbar/cwgIcon.png" style="filter: url(#main);">
                  <p>Complex WebGraph</p>
               </a>
               <a class="startMenuLink startMenuEntry" href="https://github.com/varphi-online/conway" target="_blank">
                  <img src="/sitewide/taskbar/playingGod.png">
                  <p>Playing God</p>
               </a>
               <a class="startMenuLink startMenuEntry" href="/pages/internal/sitemap/sitemap.html" rel="noreferrer">
                  <img src="/sitewide/images/icons/Web-documents.ico">
                  <p>Sitemap</p>
               </a>
               <a class="startMenuLink startMenuEntry startBorderTop" href="/index.html" rel="noreferrer">
                  <img src="/sitewide/images/icons/House with car.ico">
                  <p>Home</p>
               </a>
            </div>
         </div>
      </button>

      <input id="sbt" type="checkbox" class="taskbarEntry">
      <label for="sbt" class="win95">
         <img src="/sitewide/images/icons/INFO.ico">
         <p>Dos</p>
      </label>

      <input id="sbt2" type="checkbox" class="taskbarEntry">
      <label for="sbt2" class="win95">
         <img src="/sitewide/images/icons/INFO.ico">
         <p>tres</p>

      </label>

      <input id="sbt3" type="checkbox" class="taskbarEntry">
      <label for="sbt3" class="win95">
         <img src="/sitewide/images/icons/INFO.ico">
         <p>quattroo</p>
      </label>

      <div id="controlPanel">
         <input id="volumeIcon" type="checkbox" class="taskbarEntry">
         <label>
            <img src="/sitewide/images/icons/Volume.ico">
         </label>
         <div id="clock">
            <span id="swatchClock">@000</span>
            <script defer src="https://melonking.net/scripts/swatchTime.js"></script>
         </div>
      </div>
   </div>
   <script defer id="deferred">
      // Procedurally add elements that would just clog up readability
      const contextArrow = document.createElement("img");
      contextArrow.className = "contextArrow";
      contextArrow.src = "/sitewide/taskbar/contArr.ico";

      let startMenuFolders = Array.from(document.getElementsByClassName("startMenuFolder"));
      let startSubMenuFolders = Array.from(document.getElementsByClassName("startSubMenuFolder"));
      startMenuFolders.forEach(element => element.appendChild(contextArrow.cloneNode()));
      startSubMenuFolders.forEach(element => element.appendChild(contextArrow.cloneNode()));

      // https://melonking.net - Swatch Clock! v3.1
      // The script displays a live Swatch Internet Time clock on your website!
      // For more info on swatch time visit https://wiki.melonland.net/swatch_time
      //
      // How to this script; just paste this onto your site where ever you want the clock to show:
      // <span id="swatchClock">@000</span>
      // OR if you dont want the info link
      // <span id="swatchClock-nolink">@000</span>

      var swatchClock = document.getElementById("swatchClock");
      var swatchClockNoLink = document.getElementById("swatchClock-nolink");
      var swatchLoop = undefined;
      function updateSwatchClock() {
         // Setup clocks
         if (swatchClock != null) swatchClock.innerHTML = '<a href="https://wiki.melonland.net/swatch_time" target="_blank">&#64;' + GetSwatchTime() + "</a>";
         if (swatchClockNoLink != null) swatchClockNoLink.innerHTML = "&#64;" + GetSwatchTime();
         // Setup loop first time
         if (swatchLoop == undefined && (swatchClock != null || swatchClockNoLink != null)) swatchLoop = setInterval(updateSwatchClock, 864);
      }
      updateSwatchClock();

      // Gets the swatch time right now
      function GetSwatchTime(showDecimals = true) {
         return GetSwatchTimeAt(new Date(), showDecimals);
      }

      // Converts a given time to swatch time - takes a JS Date object
      function GetSwatchTimeAt(date, showDecimals = true) {
         // Get date in UTC/GMT
         var hours = date.getUTCHours();
         var minutes = date.getUTCMinutes();
         var seconds = date.getUTCSeconds();
         var milliseconds = date.getUTCMilliseconds();

         // Convert to Biel Mean Time (BMT), add 1 hour to UTC
         hours = (hours + 1) % 24;
         // Time in seconds since midnight BMT
         var timeInMilliseconds = ((hours * 60 + minutes) * 60 + seconds) * 1000 + milliseconds;
         // Convert milliseconds to beats - there are 86.4 seconds in a beat
         var beats = timeInMilliseconds / 86400;

         if (showDecimals) {
            return beats.toFixed(2);
         } else {
            return Math.floor(beats);
         }
      }

      // +++ Handy Functions for Swatch Time coders!! +++

      // Converts a Swatch stamp to Biel Mean Time / UTC+1 date object
      function SwatchToBMT(swatchTime) {
         let date = SwatchToUTC(swatchTime);
         date.setHours((date.getHours() + 1) % 24);
         return date;
      }

      // Converts a Swatch value to UTC date object.
      function SwatchToUTC(swatchTime) {
         //Strip any beat symbol
         swatchTime = swatchTime.replace("@", "");
         // Check if swatchTime includes decimals
         var hasDecimals = swatchTime % 1 !== 0;
         // Convert Swatch Beats to total seconds
         var totalSeconds = swatchTime * 86.4;
         // Convert total seconds to milliseconds
         var totalMilliseconds = totalSeconds * 1000;
         // Calculate hours, minutes, and seconds
         var secondsSinceMidnight = totalMilliseconds / 1000;

         // Adjust for Biel Mean Time (UTC+1)
         secondsSinceMidnight -= 3600;
         // Handle negative wraparound
         if (secondsSinceMidnight < 0) {
            secondsSinceMidnight += 86400;
         }

         var hours = String(Math.floor(secondsSinceMidnight / 3600) % 24).padStart(2, "0");
         var minutes = String(Math.floor((secondsSinceMidnight % 3600) / 60)).padStart(2, "0");
         var seconds = String(Math.floor(secondsSinceMidnight % 60)).padStart(2, "0");

         let date = new Date(`2000-01-01T${hours}:${minutes}:${seconds}`);
         date.setMilliseconds(400); // This gives a cleaner result if its converted back to swatch time again

         return date;
      }
   </script>


   <!--
   <div class="app window" data-icon="Music Disc.ico" data-windowTitle="musicPlayer2k">
      <div class="windowContent">
         lol
      </div>
   </div>

   <div class="window movableWindow" id="musicPlayer">
      <div class="windowHeader" id="musicPlayerheader">Music Player 2000</div>
      <div style="margin-bottom: 6%;" class="windowContent">
         <p>Current Song: <span id="currentSong">none</span></p>
         <button class="playerButton" onclick="previousSong()"><img src=musicPlayer/prev.png></button>
         <button class="playerButton" onclick="playPause()"><img id="musicPlayPause"
               src="musicPlayer/play.png"></button>
         <button class="playerButton" onclick="nextSong()"><img src=musicPlayer/next.png></button>
      </div>
      <div class="windowContent" id="musicSelect">
         <button class="playlistButton" onclick="changePlaylist(this, 'PLZVAe2HWDfazadVRIROx8J7FlpErhTPsA')">Website
            Music</button>
         <button class="playlistButton"
            onclick="changePlaylist(this, 'PLZVAe2HWDfaxYuXG4rOLh8QaCXeXg78lo')">Discography</button>
         <button class="playlistButton"
            onclick="changePlaylist(this, 'PLZVAe2HWDfayTn076m6xs4CKfGcaCF7KS')">Orbit</button>
         <button class="playlistButton" onclick="changePlaylist(this, 'PLZVAe2HWDfaxZY9eF1L0obp7zmpESPLQa')">An End of
            Sorts</button>
         <button class="playlistButton"
            onclick="changePlaylist(this, 'PLZVAe2HWDfaxA9_EO73LnUUJ5QJsehmC9')">FOTE6</button>
         <button class="playlistButton"
            onclick="changePlaylist(this, 'PLZVAe2HWDfayOwGFpd7C30W0lDwYx2_ey')">Singles</button>
      </div>
      <div id="musicPlayerFrame">
         <div id="player"></div>
      </div>
   </div>
   <script src="window.js"></script>
                  <div class="menuPopout" id="musicOut">
                     <div class="link">
                        <img src="https://f4.bcbits.com/img/a2371408069_10.jpg">
                        <div class="menuText">Orbit</div>
                        <a target="_parent" rel="noopener noreferrer" href="../../pages/music/orbit/orbit.html"
                           class="fill-div"></a>
                     </div>
                     <!--
                        <div class="link">
                           <img src="https://f4.bcbits.com/img/a3155449451_10.jpg">
                           <div class="menuText">Faded Horizons</div>
                           <a target="_parent" rel="noopener noreferrer" href="../../pages/music/fadedhorizons.html" class="fill-div"></a>
                        </div>
                        <div class="link">
                           <img src="https://f4.bcbits.com/img/a2378214422_10.jpg">
                           <div class="menuText">End of Sorts</div>
                           <a target="_parent" rel="noopener noreferrer" href="../../pages/music/endofsorts.html" class="fill-div"></a>
                        </div>
                        <div class="link">
                           <img src="https://f4.bcbits.com/img/a0702562904_10.jpg">
                           <div class="menuText">FOTE6</div>
                           <a target="_parent" rel="noopener noreferrer" href="../../pages/music/fote6.html" class="fill-div"></a>
                        </div>
                        <div class="link">
                           <img src="https://f4.bcbits.com/img/a2829327501_10.jpg">
                           <div class="menuText">Ergo Empty</div>
                           <a target="_parent" rel="noopener noreferrer" href="../../pages/music/ergoempty.html" class="fill-div"></a>
                        </div>
                       
      <div id=controlPanel>
         <div id=cPanelVis>
            <button id="volumeCPanel" type="button">
               <img src="/sitewide/images/icons/Volume.ico" onclick="toggleDiv('volumeControl','volumeCPanel', false)">
               <div class="window" id="volumeControl">
                  <div class="windowContent">
                     <p>Volume</p>
                     <input id=volumeSlider value="8" type="range" orient="vertical" />
                  </div>
               </div>
            </button>
            <div id="clock">
               <span id="swatchClock">@000</span>
               <script defer src="https://melonking.net/scripts/swatchTime.js"></script>
            </div>
         </div>
      </div>
      <div id="hider">
      </div>
      <script>
         function toggleDiv(toToggle, toggler, indent, toReplace) {
            toReplace = toReplace || null;
            var div = document.getElementById(String(toToggle));
            var div2 = document.getElementById(String(toggler));
            var div3 = document.getElementById(String(toReplace));
            var style = window.getComputedStyle(div);

            if (toReplace) {
               var style2 = window.getComputedStyle(div3)

               if (style2.display === "none") {
                  div2.style.display = "none";
               } else {
                  div2.style.display = "flex";
               }
            }

            if (style.display === "none") {
               div.style.display = "block";
               if (indent) {
                  div2.style.boxShadow = "inset -1px -1px #f1f0f1, inset -2px -2px #eaebea,inset 1px 1px #323132, inset 2px 2px #414041";
                  div2.style.backgroundColor = "#E0E0E0"
               }
            } else {
               div.style.display = "none";
               if (indent) {
                  div2.style.boxShadow = "inset 1px 1px #f1f0f1, inset 2px 2px #eaebea, 1px 1px #323132, 2px 2px #414041";
                  div2.style.backgroundColor = "#c6c3c6"
               }
            }
         }
      </script>
      <script>
         var tb = parent.document.getElementById("taskbar")
         function menuOpen(bool) {
            if (bool) {
               tb.style.zIndex = 100
               console.log(parent.window.getComputedStyle(tb).zIndex)
            } else {
               tb.style.zIndex = -10
               console.log(parent.window.getComputedStyle(tb).zIndex)
            }
         }
      </script>
   </div>
   <script src="musicPlayer/music.js"></script>
   -->
</body>